<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      property="og:image"
      content="https://ribdexglobal.netlify.app/src/images/unforgettable%20journey.png"
    />
    <meta
      property="og:description"
      content="Browse our complete collection of residential and land properties. Find your perfect investment opportunity with Ribdex Global."
    />
    <title>All Properties | Ribdex Global Real Estate</title>
    <link
      rel="shortcut icon"
      href="./src/icons/RIBDEX.svg"
      type="image/x-icon"
    />
    <link href="/src/css/output.css" rel="stylesheet" />
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="./src/js/script.js" defer></script>
    <script src="./src/js/animations.js" defer></script>
  </head>
  <body class="bg-gradient-to-br from-green-50 via-white to-orange-50 relative overflow-x-hidden"
  >
    <!-- Header/nav section -->
    <header class="z-[9999] bg-white/95 backdrop-blur-md py-4 md:py-5 fixed top-0 right-0 left-0 shadow-soft transition-all duration-300">
      <div class="container px-5 flex mx-auto justify-between items-center">
        <a href="./index.html" class="transform hover:scale-105 transition-transform duration-300">
          <div class="flex justify-start items-center gap-3">
            <img class="w-12 md:w-20 relative animate-pulse-slow" src="/src/icons/RIBDEX.svg" alt="Ribdex Global Logo" />
            <span class="hidden lg:block text-primary-700 font-head font-bold text-xl">RIBDEX</span>
          </div>
        </a>

        <!-- desktop nav menu -->
        <nav>
          <div class="hidden md:flex justify-start items-center gap-8">
            <a href="./index.html#" class="text-primary-700 hover:text-accent-600 text-lg font-bold font-head uppercase relative group transition-colors duration-300">
              home
              <span class="absolute bottom-0 left-0 w-0 h-0.5 bg-accent-600 group-hover:w-full transition-all duration-300"></span>
            </a>
            <a href="#residence" class="text-primary-700 hover:text-accent-600 text-lg font-bold font-head uppercase relative group transition-colors duration-300">
              residence
              <span class="absolute bottom-0 left-0 w-0 h-0.5 bg-accent-600 group-hover:w-full transition-all duration-300"></span>
            </a>
            <a href="#land" class="text-primary-700 hover:text-accent-600 text-lg font-bold font-head uppercase relative group transition-colors duration-300">
              land
              <span class="absolute bottom-0 left-0 w-0 h-0.5 bg-accent-600 group-hover:w-full transition-all duration-300"></span>
            </a>
            <a href="./index.html#contact" class="text-primary-700 hover:text-accent-600 text-lg font-bold font-head uppercase relative group transition-colors duration-300">
              contact
              <span class="absolute bottom-0 left-0 w-0 h-0.5 bg-accent-600 group-hover:w-full transition-all duration-300"></span>
            </a>
          </div>

          <!-- hamburger menu -->
          <button id="hamburger-btn" class="md:hidden p-2 hover:bg-gray-100 rounded-lg transition-colors duration-200">
            <i data-lucide="menu" class="w-6 h-6 text-primary-700"></i>
          </button>
        </nav>
      </div>

      <!-- mobile menu -->
      <div id="mobile-menu" class="absolute glass-effect top-full left-0 right-0 h-0 overflow-hidden flex flex-col justify-start items-start transition-all duration-300 shadow-lg">
        <div class="w-full flex flex-col bg-white/95 backdrop-blur-md">
          <a href="./index.html#" class="hover:bg-primary-50 text-lg font-bold font-head uppercase px-6 py-4 w-full text-primary-700 border-b border-gray-100 transition-colors duration-200">home</a>
          <a href="#residence" class="hover:bg-primary-50 text-lg font-bold font-head uppercase px-6 py-4 w-full text-primary-700 border-b border-gray-100 transition-colors duration-200">residence</a>
          <a href="#land" class="hover:bg-primary-50 text-lg font-bold font-head uppercase px-6 py-4 w-full text-primary-700 border-b border-gray-100 transition-colors duration-200">land</a>
          <a href="./index.html#contact" class="hover:bg-primary-50 text-lg font-bold font-head uppercase px-6 py-4 w-full text-primary-700 transition-colors duration-200">contact</a>
        </div>
      </div>
    </header>

    <!-- hero section -->
    <div class="relative overflow-hidden">
      <div class="relative w-full pt-32 pb-20 md:pt-40 md:pb-24 bg-cover bg-center" style="background-image: url('./src/images/house1.jpg'); background-position: center; background-attachment: fixed;" data-parallax="0.3">
        <div class="container mx-auto z-10 relative px-6 md:px-12 text-center space-y-6">
          <h1 class="text-white text-4xl md:text-6xl font-bold font-head uppercase leading-tight animate-fade-in-down">
            Browse All Properties
          </h1>
          <p class="text-white/90 text-lg md:text-xl font-body max-w-3xl mx-auto animate-fade-in-up">
            Discover a wide range of properties, from residential to commercial, and expert services to match your needs.
          </p>
          
          <!-- Filter Buttons -->
          <div class="flex flex-wrap justify-center gap-4 pt-8 animate-fade-in-up">
            <button onclick="filterProperties('all')" class="filter-btn active px-6 py-3 bg-white text-primary-700 font-bold font-head uppercase rounded-lg hover:bg-accent-600 hover:text-white transition-all duration-300 flex items-center gap-2">
              <i data-lucide="layout-grid" class="w-5 h-5"></i>
              <span>All Properties</span>
            </button>
            <button onclick="filterProperties('residence')" class="filter-btn px-6 py-3 bg-white/90 text-primary-700 font-bold font-head uppercase rounded-lg hover:bg-accent-600 hover:text-white transition-all duration-300 flex items-center gap-2">
              <i data-lucide="home" class="w-5 h-5"></i>
              <span>Residence</span>
            </button>
            <button onclick="filterProperties('land')" class="filter-btn px-6 py-3 bg-white/90 text-primary-700 font-bold font-head uppercase rounded-lg hover:bg-accent-600 hover:text-white transition-all duration-300 flex items-center gap-2">
              <i data-lucide="map" class="w-5 h-5"></i>
              <span>Land</span>
            </button>
          </div>
        </div>
      </div>
    </div>

    
    <!-- property listing -->
    <section class="bg-gradient-to-br from-gray-50 to-white py-20 md:py-32">
      <div class="container mx-auto px-6">
        <!-- Residence Section -->
        <div class="mb-20" id="residence">
          <div class="text-center mb-12 animate-on-scroll">
            <div class="inline-flex items-center gap-2 px-4 py-2 bg-primary-100 text-primary-700 rounded-full font-semibold text-sm uppercase mb-4">
              <i data-lucide="home" class="w-4 h-4"></i>
              <span>Residential Properties</span>
            </div>
            <h2 class="text-primary-800 text-3xl md:text-5xl font-bold font-head uppercase">Residence Listing</h2>
          </div>
          
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8" id="residence-card">
            <!-- Properties will be dynamically inserted here -->
          </div>
        </div>

        <!-- Land Section -->
        <div id="land">
          <div class="text-center mb-12 animate-on-scroll">
            <div class="inline-flex items-center gap-2 px-4 py-2 bg-accent-100 text-accent-700 rounded-full font-semibold text-sm uppercase mb-4">
              <i data-lucide="map" class="w-4 h-4"></i>
              <span>Land Properties</span>
            </div>
            <h2 class="text-primary-800 text-3xl md:text-5xl font-bold font-head uppercase">Land Listing</h2>
          </div>
          
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8" id="land-card">
            <!-- Properties will be dynamically inserted here -->
          </div>
        </div>
      </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gradient-to-br from-primary-900 via-primary-800 to-primary-900 text-white">
      <div class="container mx-auto px-6 py-12">
        <div class="border-t border-white/10 pt-8">
          <div class="flex flex-col md:flex-row justify-between items-center gap-4">
            <p class="text-white/60 text-sm md:text-base font-body">
              © <span class="copyright-year">2024</span> Ribdex Properties. All rights reserved.
            </p>
            <div class="flex items-center gap-4">
              <a href="/facebook" target="_blank" rel="noopener noreferrer" class="bg-white/10 hover:bg-accent-600 p-2 rounded-full transition-all duration-300">
                <i data-lucide="facebook" class="w-5 h-5"></i>
              </a>
              <a href="/twitter" target="_blank" rel="noopener noreferrer" class="bg-white/10 hover:bg-accent-600 p-2 rounded-full transition-all duration-300">
                <i data-lucide="twitter" class="w-5 h-5"></i>
              </a>
              <a href="/instagram" target="_blank" rel="noopener noreferrer" class="bg-white/10 hover:bg-accent-600 p-2 rounded-full transition-all duration-300">
                <i data-lucide="instagram" class="w-5 h-5"></i>
              </a>
              <a href="http://linkedin.com/ribdex" target="_blank" rel="noopener noreferrer" class="bg-white/10 hover:bg-accent-600 p-2 rounded-full transition-all duration-300">
                <i data-lucide="linkedin" class="w-5 h-5"></i>
              </a>
            </div>
          </div>
        </div>
      </div>
    </footer>

    <script>
      lucide.createIcons();
      
      function filterProperties(type) {
        const residenceSection = document.getElementById('residence');
        const landSection = document.getElementById('land');
        const filterBtns = document.querySelectorAll('.filter-btn');
        
        filterBtns.forEach(btn => btn.classList.remove('active', 'bg-accent-600', 'text-white'));
        event.target.closest('.filter-btn').classList.add('active', 'bg-accent-600', 'text-white');
        
        if (type === 'all') {
          residenceSection.classList.remove('hidden');
          landSection.classList.remove('hidden');
        } else if (type === 'residence') {
          residenceSection.classList.remove('hidden');
          landSection.classList.add('hidden');
          residenceSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
        } else if (type === 'land') {
          residenceSection.classList.add('hidden');
          landSection.classList.remove('hidden');
          landSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
      }
    </script>
  </body><script type="module">
    // Import the functions you need from the SDKs you need
    // Initialize Firebase
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.19.1/firebase-app.js";
    import {
      getDatabase,
      ref as databaseRef,
      set,
      get,
      child,
      update,
      remove,
    } from "https://www.gstatic.com/firebasejs/9.19.1/firebase-database.js";
    // TODO: Add SDKs for Firebase products that you want to use
    // https://firebase.google.com/docs/web/setup#available-libraries

    // Your web app's Firebase configuration
    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
    const firebaseConfig = {
      apiKey: "AIzaSyCWQ552it5NQwc7LCqlZ9LS2TPfYRv5S9w",
      authDomain: "real-ribdex-property.firebaseapp.com",
      projectId: "real-ribdex-property",
      storageBucket: "real-ribdex-property.firebasestorage.app",
      messagingSenderId: "634531624880",
      appId: "1:634531624880:web:872297c7bfa67dd7150875",
      databaseURL: "https://real-ribdex-property-default-rtdb.firebaseio.com",
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    let propData = "";
    const resideEl = document.querySelector("#residence");
    const landEl = document.querySelector("#land");

    // display proerty per object parsed
    const dispProps = (objData) => {
      console.log(objData);
      for (const prop in objData) {
        if (prop !== "land") {
          // console.log(prop)
          for (const estate in objData[prop]) {
            const property = objData[prop][estate];
            let isAvailable;
            if (property.available){
              isAvailable = `<p style="top: 10px; right: 10px; padding: 10px 15px; font-weight: 800; background: green;" class="absolute top-[10px] right-[10px] bg-green-900 px-[15px] py-[10px] text-[12px] text-white">Available</p>`
            } else {
              isAvailable = `<p style="top: 10px; right: 10px; padding: 10px 15px; font-weight: 800; background: red;" class="absolute top-[10px] right-[10px] bg-red-900 px-[15px] py-[10px] text-[12px] text-white">Not Available</p>`
            }
            const formattedPrice = formatNumberWithCommas(property.priceNaira);
            document.getElementById('residence-card').innerHTML += `<div class="card property-card group overflow-hidden">
              <div class="relative overflow-hidden">
                <img
                  src="${property.propertyImage}"
                  class="w-full h-72 object-cover transform group-hover:scale-110 transition-transform duration-500"
                  alt="${estate}"
                />
                <div class="absolute inset-0 bg-gradient-to-t from-black/50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                ${isAvailable}
                <div class="absolute top-4 left-4 bg-white/90 backdrop-blur-sm px-3 py-1 rounded-full flex items-center gap-2">
                  <i data-lucide="home" class="w-4 h-4 text-primary-600"></i>
                  <span class="text-sm font-semibold text-primary-600">Residence</span>
                </div>
              </div>
              <div class="p-6 space-y-4">
                <h3 class="font-head text-xl text-primary-700 uppercase font-bold group-hover:text-accent-600 transition-colors duration-300">
                  ${estate}
                </h3>
                <div class="flex items-center gap-2 text-gray-600">
                  <i data-lucide="map-pin" class="w-4 h-4 text-accent-600"></i>
                  <span class="text-sm">${property.propertyLocation}</span>
                </div>
                <div class="flex justify-between items-center pt-4 border-t border-gray-100">
                  <div class="flex items-center gap-2">
                    <i data-lucide="tag" class="w-5 h-5 text-primary-600"></i>
                    <span class="font-bold text-lg text-primary-800">₦${formattedPrice}</span>
                  </div>
                  <div class="flex items-center gap-2 text-gray-600">
                    <i data-lucide="bed-double" class="w-5 h-5 text-accent-600"></i>
                    <span class="text-sm font-medium">${property.propertySize} bed</span>
                  </div>
                </div>
                <a href="./prop.html?type=${property.propertyType}&title=${estate}" class="block mt-4">
                  <button class="btn-primary w-full justify-center group-hover:scale-105">
                    <span>View Details</span>
                    <i data-lucide="arrow-right" class="w-4 h-4"></i>
                  </button>
                </a>
              </div>
            </div>`
            setTimeout(() => lucide.createIcons(), 100);
          }
        } else {
          for (const estate in objData[prop]) {
            const property = objData[prop][estate];
            let isAvailable;
            if (property.available){
              isAvailable = `<p style="top: 10px; right: 10px; padding: 10px 15px; font-weight: 800; background: green;" class="absolute top-[10px] right-[10px] bg-green-900 px-[15px] py-[10px] text-[12px] text-white">Available</p>`
            } else {
              isAvailable = `<p style="top: 10px; right: 10px; padding: 10px 15px; font-weight: 800; background: red;" class="absolute top-[10px] right-[10px] bg-red-900 px-[15px] py-[10px] text-[12px] text-white">Not Available</p>`
            }
            const formattedPrice = formatNumberWithCommas(property.priceNaira);
            document.getElementById('land-card').innerHTML += `<div class="card property-card group overflow-hidden">
              <div class="relative overflow-hidden">
                <img
                  src="${property.propertyImage}"
                  class="w-full h-72 object-cover transform group-hover:scale-110 transition-transform duration-500"
                  alt="${estate}"
                />
                <div class="absolute inset-0 bg-gradient-to-t from-black/50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                ${isAvailable}
                <div class="absolute top-4 left-4 bg-white/90 backdrop-blur-sm px-3 py-1 rounded-full flex items-center gap-2">
                  <i data-lucide="map" class="w-4 h-4 text-accent-600"></i>
                  <span class="text-sm font-semibold text-accent-600">Land</span>
                </div>
              </div>
              <div class="p-6 space-y-4">
                <h3 class="font-head text-xl text-primary-700 uppercase font-bold group-hover:text-accent-600 transition-colors duration-300">
                  ${estate}
                </h3>
                <div class="flex items-center gap-2 text-gray-600">
                  <i data-lucide="map-pin" class="w-4 h-4 text-accent-600"></i>
                  <span class="text-sm">${property.propertyLocation}</span>
                </div>
                <div class="flex justify-between items-center pt-4 border-t border-gray-100">
                  <div class="flex items-center gap-2">
                    <i data-lucide="tag" class="w-5 h-5 text-primary-600"></i>
                    <span class="font-bold text-lg text-primary-800">₦${formattedPrice}</span>
                  </div>
                  <div class="flex items-center gap-2 text-gray-600">
                    <i data-lucide="ruler" class="w-5 h-5 text-accent-600"></i>
                    <span class="text-sm font-medium">${property.propertySize} sqm</span>
                  </div>
                </div>
                <a href="./prop.html?type=${property.propertyType}&title=${estate}" class="block mt-4">
                  <button class="btn-primary w-full justify-center group-hover:scale-105">
                    <span>View Details</span>
                    <i data-lucide="arrow-right" class="w-4 h-4"></i>
                  </button>
                </a>
              </div>
            </div>`
            setTimeout(() => lucide.createIcons(), 100);
          }
        }
        console.log("done");
      }
    };

    function getpropIndv() {
      resideEl.classList.add("hidden");
      landEl.classList.add("hidden");
      const database = getDatabase();
      const dataRef = databaseRef(database, "properties/");
      console.log("startting");

      get(dataRef)
        .then((snapshot) => {
          if (snapshot.exists()) {
            console.log(snapshot);
            let propDatas = snapshot.val();
            propData = propDatas;
            localStorage.setItem("propDataStore", JSON.stringify(propData));
            const lsPropData = JSON.parse(
              localStorage.getItem("propDataStore")
            );
            resideEl.classList.remove("hidden");
            landEl.classList.remove("hidden");
            dispProps({ land: lsPropData["land"] });
            dispProps({ rent: lsPropData["rent"] });
            dispProps({ house: lsPropData["house"] });
          } else {
            console.log("No data available");
          }
        })
        .catch((error) => {
          console.error(error);
        });
    }
    getpropIndv();

    // format price to display with ',' - comma
    function formatNumberWithCommas(number) {
      return number.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    }

    // Handle URL search parameters
    function handleSearchParams() {
      const urlParams = new URLSearchParams(window.location.search);
      const searchLocation = urlParams.get('location');
      const searchType = urlParams.get('type');
      
      if (searchLocation || searchType) {
        // Filter properties based on search parameters
        filterPropertiesBySearch(searchLocation, searchType);
        
        // Update filter buttons to show active state
        if (searchType) {
          const filterBtns = document.querySelectorAll('.filter-btn');
          filterBtns.forEach(btn => btn.classList.remove('active', 'bg-accent-600', 'text-white'));
          
          if (searchType === 'land') {
            filterBtns[2].classList.add('active', 'bg-accent-600', 'text-white');
          } else {
            filterBtns[1].classList.add('active', 'bg-accent-600', 'text-white');
          }
        }
      }
    }

    function filterPropertiesBySearch(location, type) {
      const residenceSection = document.getElementById('residence');
      const landSection = document.getElementById('land');
      const residenceCards = document.querySelectorAll('#residence-card .property-card');
      const landCards = document.querySelectorAll('#land-card .property-card');
      
      // Show/hide sections based on type
      if (type === 'land') {
        residenceSection.classList.add('hidden');
        landSection.classList.remove('hidden');
      } else if (type === 'house' || type === 'rent') {
        residenceSection.classList.remove('hidden');
        landSection.classList.add('hidden');
      } else {
        residenceSection.classList.remove('hidden');
        landSection.classList.remove('hidden');
      }
      
      // Filter by location if specified
      if (location) {
        const searchLocationLower = location.toLowerCase();
        
        residenceCards.forEach(card => {
          const cardLocation = card.querySelector('[data-lucide="map-pin"]')?.nextElementSibling?.textContent || '';
          if (cardLocation.toLowerCase().includes(searchLocationLower)) {
            card.style.display = '';
          } else {
            card.style.display = 'none';
          }
        });
        
        landCards.forEach(card => {
          const cardLocation = card.querySelector('[data-lucide="map-pin"]')?.nextElementSibling?.textContent || '';
          if (cardLocation.toLowerCase().includes(searchLocationLower)) {
            card.style.display = '';
          } else {
            card.style.display = 'none';
          }
        });
      }
      
      // Scroll to the appropriate section
      if (type === 'land') {
        setTimeout(() => landSection.scrollIntoView({ behavior: 'smooth', block: 'start' }), 300);
      } else if (type === 'house' || type === 'rent') {
        setTimeout(() => residenceSection.scrollIntoView({ behavior: 'smooth', block: 'start' }), 300);
      }
    }

    // Wait for properties to load, then handle search params
    setTimeout(() => {
      handleSearchParams();
    }, 1000);
  </script>
</html>
